apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: nuwa-webhook
webhooks:
  - name: injector.nuwa.nip.io
    admissionReviewVersions: ["v1", "v1beta1"]
    sideEffects: NoneOnDryRun
    rules:
      - operations: [ "CREATE" ]
        apiGroups: [""]
        apiVersions: ["v1"]
        resources: ["pods"]
        scope: "Namespaced"
    failurePolicy: Ignore  #  Fail/Ignore
    clientConfig:
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQ5VENDQXQyZ0F3SUJBZ0lVS04vTFZmM1l5aE5HZU0zUnBTM2pQNlQvckZzd0RRWUpLb1pJaHZjTkFRRUwKQlFBd2NqRUxNQWtHQTFVRUJoTUNRMDR4RWpBUUJnTlZCQWdUQ1VkMVlXNW5XbWh2ZFRFU01CQUdBMVVFQnhNSgpSM1ZoYm1kYWFHOTFNUXd3Q2dZRFZRUUtFd05yT0hNeER6QU5CZ05WQkFzVEJsTjVjM1JsYlRFY01Cb0dBMVVFCkF4TVRhM1ZpWlhKdVpYUmxjeTFUYjNWc2JXRjBaVEFlRncweU1EQTFNRE13TXpVNU1EQmFGdzAwTURBME1qZ3cKTXpVNU1EQmFNR014Q3pBSkJnTlZCQVlUQWtOT01SSXdFQVlEVlFRSUV3bEhkV0Z1WjFwb2IzVXhFakFRQmdOVgpCQWNUQ1VkMVlXNW5XbWh2ZFRFTU1Bb0dBMVVFQ2hNRGF6aHpNUTh3RFFZRFZRUUxFd1pUZVhOMFpXMHhEVEFMCkJnTlZCQU1UQkc1MWQyRXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFDLzJ1WmEKS1IvRk1EUGZuMVZGbVozOThhejkvMVJxVlp3RHVNdGRHdlhGUDdoV2JQdmVWVzdBWlRLSFFrZHUrdDkrbjRwTgpyS1p4b241eUdQeHJncWxkZGVrN2YvTy9JQi9YOUhRN1JyL3N1ZGN0RDB6aThpRUc4QUd1dmNlNkZjNXQ2RDRBCk4vZ3I5dGRaWjFkNnIyVWFGWm55MmVKbFZJdHFKaDl3bEtKYlc0UHVGcmpzVGo3aHJydDdES2NUbTJuTkZoVlUKb1pFWFVBQ1ZFU0tLTWwvd0hBRjYvLy9KRUE5clFGQmxvK3lSNkptdHM1T05NY05adVM4VTFBUTc0UndmNU5SWgp2dkM2R1NqaHAxa01hVGJXT0ZtSWpMbzdRWmdkMzJQVjlma2ZuZkNSSmNRdnF3VU1zUWpsOVd5SEJ2VE9TV3VZCm9iYzZaMUFzM0JkV1k5Y0ZBZ01CQUFHamdaRXdnWTR3RGdZRFZSMFBBUUgvQkFRREFnV2dNQjBHQTFVZEpRUVcKTUJRR0NDc0dBUVVGQndNQkJnZ3JCZ0VGQlFjREFqQU1CZ05WSFJNQkFmOEVBakFBTUIwR0ExVWREZ1FXQkJUTwpwZnozcGlMd2JkejdhZGlYU01tUGdlUytEakFmQmdOVkhTTUVHREFXZ0JUZnI4SmloUFNEN0NHQUtJU1RpakxKCm9hQzVaakFQQmdOVkhSRUVDREFHaHdRSzB6Y0NNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJOQzJnSXZJNjYKN3pCbzc0VHBOSHdTMEEwZlVxTXM2R3JwZHZkT0lockNIaWY0eUo0dWxXcXBTTW81RVNhSGcrS0pCeGZOKzR4eQpVTS9EQWNCNDVaL2FIUjhOSzJzdlpMK2VHSUJkTTgxLzRYNTc3cTVrYS9lQW5LMy8yaVdzWmN1WjRENGFzLzM5CjdvOUZkSXZMMW80Uy9wRlY2VWRPRndoRTgwRWxreTBJUnJSZnNqeXpwRnUyRldnOFY0VHhpTU5KaWdTN1MyUXIKOFBiUzZoQ1FxbjlueHYrejkwZ2c4eXBuRkVobmhna0thN0x0dXBzNGQyaXc1MjUxT1ZISTkrSlRXcm1oZjhOSApadlNYeitQemI1TzhHSk1xUjUyNnRYVS9nZXdSZ1g3aGs2TzRxYnFaaGNaakprZit6SDB1NXo3UWcyMmN1eHA1CjZCaHM3ZGdlVis4MwotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
      service:
        name: nuwa-webhook-service
        namespace: kube-system
        path: /injector-mutating-pods
        port: 1443
  - name: namespace.nuwa.nip.io
    admissionReviewVersions: ["v1", "v1beta1"]
    sideEffects: NoneOnDryRun
    rules:
      - operations: [ "CREATE" ]
        apiGroups: ["","apps","batch"]
        apiVersions: ["v1","v1beta1"]
        resources: ["replicationcontrollers","replicasets","jobs","cronjobs","deployments","statefulset"]
        scope: "Namespaced"
    failurePolicy: Ignore  #  Fail/Ignore
    clientConfig:
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQ5VENDQXQyZ0F3SUJBZ0lVS04vTFZmM1l5aE5HZU0zUnBTM2pQNlQvckZzd0RRWUpLb1pJaHZjTkFRRUwKQlFBd2NqRUxNQWtHQTFVRUJoTUNRMDR4RWpBUUJnTlZCQWdUQ1VkMVlXNW5XbWh2ZFRFU01CQUdBMVVFQnhNSgpSM1ZoYm1kYWFHOTFNUXd3Q2dZRFZRUUtFd05yT0hNeER6QU5CZ05WQkFzVEJsTjVjM1JsYlRFY01Cb0dBMVVFCkF4TVRhM1ZpWlhKdVpYUmxjeTFUYjNWc2JXRjBaVEFlRncweU1EQTFNRE13TXpVNU1EQmFGdzAwTURBME1qZ3cKTXpVNU1EQmFNR014Q3pBSkJnTlZCQVlUQWtOT01SSXdFQVlEVlFRSUV3bEhkV0Z1WjFwb2IzVXhFakFRQmdOVgpCQWNUQ1VkMVlXNW5XbWh2ZFRFTU1Bb0dBMVVFQ2hNRGF6aHpNUTh3RFFZRFZRUUxFd1pUZVhOMFpXMHhEVEFMCkJnTlZCQU1UQkc1MWQyRXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFDLzJ1WmEKS1IvRk1EUGZuMVZGbVozOThhejkvMVJxVlp3RHVNdGRHdlhGUDdoV2JQdmVWVzdBWlRLSFFrZHUrdDkrbjRwTgpyS1p4b241eUdQeHJncWxkZGVrN2YvTy9JQi9YOUhRN1JyL3N1ZGN0RDB6aThpRUc4QUd1dmNlNkZjNXQ2RDRBCk4vZ3I5dGRaWjFkNnIyVWFGWm55MmVKbFZJdHFKaDl3bEtKYlc0UHVGcmpzVGo3aHJydDdES2NUbTJuTkZoVlUKb1pFWFVBQ1ZFU0tLTWwvd0hBRjYvLy9KRUE5clFGQmxvK3lSNkptdHM1T05NY05adVM4VTFBUTc0UndmNU5SWgp2dkM2R1NqaHAxa01hVGJXT0ZtSWpMbzdRWmdkMzJQVjlma2ZuZkNSSmNRdnF3VU1zUWpsOVd5SEJ2VE9TV3VZCm9iYzZaMUFzM0JkV1k5Y0ZBZ01CQUFHamdaRXdnWTR3RGdZRFZSMFBBUUgvQkFRREFnV2dNQjBHQTFVZEpRUVcKTUJRR0NDc0dBUVVGQndNQkJnZ3JCZ0VGQlFjREFqQU1CZ05WSFJNQkFmOEVBakFBTUIwR0ExVWREZ1FXQkJUTwpwZnozcGlMd2JkejdhZGlYU01tUGdlUytEakFmQmdOVkhTTUVHREFXZ0JUZnI4SmloUFNEN0NHQUtJU1RpakxKCm9hQzVaakFQQmdOVkhSRUVDREFHaHdRSzB6Y0NNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJOQzJnSXZJNjYKN3pCbzc0VHBOSHdTMEEwZlVxTXM2R3JwZHZkT0lockNIaWY0eUo0dWxXcXBTTW81RVNhSGcrS0pCeGZOKzR4eQpVTS9EQWNCNDVaL2FIUjhOSzJzdlpMK2VHSUJkTTgxLzRYNTc3cTVrYS9lQW5LMy8yaVdzWmN1WjRENGFzLzM5CjdvOUZkSXZMMW80Uy9wRlY2VWRPRndoRTgwRWxreTBJUnJSZnNqeXpwRnUyRldnOFY0VHhpTU5KaWdTN1MyUXIKOFBiUzZoQ1FxbjlueHYrejkwZ2c4eXBuRkVobmhna0thN0x0dXBzNGQyaXc1MjUxT1ZISTkrSlRXcm1oZjhOSApadlNYeitQemI1TzhHSk1xUjUyNnRYVS9nZXdSZ1g3aGs2TzRxYnFaaGNaakprZit6SDB1NXo3UWcyMmN1eHA1CjZCaHM3ZGdlVis4MwotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
      service:
        name: nuwa-webhook-service
        namespace: kube-system
        path: /namespace-mutating-resource
        port: 1443
